<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Classy Vision · An end-to-end framework for image and video classification</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="An end-to-end framework for image and video classification"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Classy Vision · An end-to-end framework for image and video classification"/><meta property="og:type" content="website"/><meta property="og:url" content="https://classyvision.ai/"/><meta property="og:description" content="An end-to-end framework for image and video classification"/><meta property="og:image" content="https://classyvision.ai/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://classyvision.ai/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code_block_buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.png" alt="Classy Vision"/><h2 class="headerTitleWithLogo">Classy Vision</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/api/" target="_self">API Reference</a></li><li class=""><a href="https://github.com/facebookresearch/ClassyVision" target="_self">GitHub</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div>
<script type="text/javascript" id="documentation_options" data-url_root="./"
  src="/js/documentation_options.js"></script>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/underscore.js"></script>
<script type="text/javascript" src="/js/doctools.js"></script>
<script type="text/javascript" src="/js/language_data.js"></script>
<script type="text/javascript" src="/js/searchtools.js"></script>
<div class="sphinx"><div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<section id="module-classy_vision.models">
<span id="models"></span><h1>Models<a class="headerlink" href="#module-classy_vision.models" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.AnyNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">AnyNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.AnyNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of an AnyNet.</p>
<p>See <a class="reference external" href="https://arxiv.org/abs/2003.13678">https://arxiv.org/abs/2003.13678</a> for details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.AnyNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">classy_vision.models.anynet.AnyNetParams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.AnyNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for ClassyModel.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.AnyNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.AnyNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.AnyNet.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.models.AnyNet" title="classy_vision.models.anynet.AnyNet"><span class="pre">classy_vision.models.anynet.AnyNet</span></a></span></span><a class="headerlink" href="#classy_vision.models.AnyNet.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates an AnyNet from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for an AnyNet.
See <cite>AnyNetParams</cite> for parameters expected in the config.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An AnyNet instance.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.ClassyBlock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">ClassyBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a thin wrapper for head execution, which records the output of
wrapped module for executing the heads forked from this module.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyBlock.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyBlock.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyBlock.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyBlock.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">ClassyModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for models in classy vision.</p>
<p>A model refers either to a specific architecture (e.g. ResNet50) or a
family of architectures (e.g. ResNet). Models can take arguments in the
constructor in order to configure different behavior (e.g.
hyperparameters).  Classy Models must implement <a class="reference internal" href="#classy_vision.models.ClassyModel.from_config" title="classy_vision.models.ClassyModel.from_config"><code class="xref py py-func docutils literal notranslate"><span class="pre">from_config()</span></code></a> in
order to allow instantiation from a configuration file. Like regular
PyTorch models, Classy Models must also implement <a class="reference internal" href="#classy_vision.models.ClassyModel.forward" title="classy_vision.models.ClassyModel.forward"><code class="xref py py-func docutils literal notranslate"><span class="pre">forward()</span></code></a>, where
the bulk of the inference logic lives.</p>
<p>Classy Models also have some advanced functionality for production
fine-tuning systems. For example, we allow users to train a trunk
model and then attach heads to the model via the attachable
blocks.  Making your model support the trunk-heads paradigm is
completely optional.</p>
<dl class="simple">
<dt>NOTE: Advanced users can modify the behavior of their implemented models by</dt><dd><p>specifying the <cite>wrapper_cls</cite> class attribute, which should be a class
derived from <a class="reference internal" href="#classy_vision.models.ClassyModelWrapper" title="classy_vision.models.ClassyModelWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassyModelWrapper</span></code></a> (see the documentation for that class
for more information). Users can set it to <cite>None</cite> to skip wrapping their model
and to make their model torchscriptable. This is set to
<a class="reference internal" href="#classy_vision.models.ClassyModelHeadExecutorWrapper" title="classy_vision.models.ClassyModelHeadExecutorWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassyModelHeadExecutorWrapper</span></code></a> by default.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for ClassyModel.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.attachable_block_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">attachable_block_names</span></span><a class="headerlink" href="#classy_vision.models.ClassyModel.attachable_block_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Return names of all attachable blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.extract_features">
<span class="sig-name descname"><span class="pre">extract_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.extract_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract features from the model.</p>
<p>Derived classes can implement this method to extract the features before
applying the final fully connected layer.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.models.ClassyModel" title="classy_vision.models.classy_model.ClassyModel"><span class="pre">classy_vision.models.classy_model.ClassyModel</span></a></span></span><a class="headerlink" href="#classy_vision.models.ClassyModel.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a ClassyModel from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for the ClassyModel.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A ClassyModel instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.from_model">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.0)"><span class="pre">torch.nn.modules.module.Module</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.from_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts an <code class="xref py py-class docutils literal notranslate"><span class="pre">nn.Module</span></code> to a <cite>ClassyModel</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The model to convert</p></li>
<li><p><strong>args</strong> (<em>For the remaining</em>) – </p></li>
<li><p><strong>ClassyModel</strong> (<em>look at the corresponding properties of</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A ClassyModel instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.get_classy_state">
<span class="sig-name descname"><span class="pre">get_classy_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep_copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.get_classy_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state of the ClassyModel.</p>
<p>The returned state is used for checkpointing.</p>
<dl class="simple">
<dt>NOTE: For advanced users, the structure of the returned dict is -</dt><dd><p><cite>{“model”: {“trunk”: trunk_state, “heads”: heads_state}}</cite>.
The trunk state is the state of the model when no heads are attached.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deep_copy</strong> – If True, creates a deep copy of the state Dict. Otherwise, the
returned Dict’s state will be tied to the object’s.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A state dictionary containing the state of the model.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.get_heads">
<span class="sig-name descname"><span class="pre">get_heads</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.get_heads" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the heads on the model</p>
<p>Function returns the heads a dictionary of block names to
<a class="reference external" href="https://pytorch.org/docs/stable/nn.html#torch.nn.Module">nn.Modules</a>
attached to that block.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.head_outputs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">head_outputs</span></span><a class="headerlink" href="#classy_vision.models.ClassyModel.head_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return outputs of all heads in the format of Dict[head_id, output]</p>
<p>Head outputs are cached during a forward pass.</p>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.input_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#classy_vision.models.ClassyModel.input_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the input shape that the model can accept, excluding the batch dimension.</p>
<p>By default it returns (3, 224, 224).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.load_head_states">
<span class="sig-name descname"><span class="pre">load_head_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.load_head_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Load only the state (weights) of the heads.</p>
<p>For a trunk-heads model, this function allows the user to
only update the head state of the model. Useful for attaching
fine-tuned heads to a pre-trained trunk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Dict</em>) – Contains the classy model state under key “model”</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.set_classy_state">
<span class="sig-name descname"><span class="pre">set_classy_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.set_classy_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the state of the ClassyModel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_dict</strong> – The state dictionary. Must be the output of a call to
<a class="reference internal" href="#classy_vision.models.ClassyModel.get_classy_state" title="classy_vision.models.ClassyModel.get_classy_state"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_classy_state()</span></code></a>.</p>
</dd>
</dl>
<p>This is used to load the state of the model from a checkpoint.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.set_heads">
<span class="sig-name descname"><span class="pre">set_heads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="heads.html#classy_vision.heads.ClassyHead" title="classy_vision.heads.classy_head.ClassyHead"><span class="pre">classy_vision.heads.classy_head.ClassyHead</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModel.set_heads" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach all the heads to corresponding blocks.</p>
<p>A head is expected to be a ClassyHead object. For more
details, see <a class="reference internal" href="heads.html#classy_vision.heads.ClassyHead" title="classy_vision.heads.ClassyHead"><code class="xref py py-class docutils literal notranslate"><span class="pre">classy_vision.heads.ClassyHead</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>heads</strong> (<em>Dict</em>) – <p>a mapping between attachable block name
and a list of heads attached to that block. For
example, if you have two different teams that want to
attach two different heads for downstream classifiers to
the 15th block, then they would use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">heads</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"block15"</span><span class="p">:</span>
    <span class="p">[</span><span class="n">classifier_head1</span><span class="p">,</span> <span class="n">classifier_head2</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModel.wrapper_cls">
<span class="sig-name descname"><span class="pre">wrapper_cls</span></span><a class="headerlink" href="#classy_vision.models.ClassyModel.wrapper_cls" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#classy_vision.models.ClassyModelHeadExecutorWrapper" title="classy_vision.models.classy_model.ClassyModelHeadExecutorWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">classy_vision.models.classy_model.ClassyModelHeadExecutorWrapper</span></code></a></p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModelHeadExecutorWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">ClassyModelHeadExecutorWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classy_model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModelHeadExecutorWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper which changes the forward to also execute and return head output.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModelWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">ClassyModelWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classy_model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModelWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Base ClassyModel wrapper class.</p>
<p>This class acts as a thin pass through wrapper which lets users modify the behavior
of ClassyModels, such as changing the return output of the forward() call.
This wrapper acts as a ClassyModel by itself and the underlying model can be
accessed by the <cite>classy_model</cite> attribute.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModelWrapper.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModelWrapper.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Call self as a function.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ClassyModelWrapper.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classy_model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ClassyModelWrapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.DenseNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">DenseNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.DenseNet" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.DenseNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">growth_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_bn_relu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_se</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_reduction_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.DenseNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of a standard densely connected network (DenseNet).</p>
<dl>
<dt>Contains the following attachable blocks:</dt><dd><dl class="simple">
<dt>block{block_idx}-{idx}: This is the output of each dense block,</dt><dd><p>indexed by the block index and the index of the dense layer</p>
</dd>
</dl>
<p>transition-{idx}: This is the output of the transition layers
trunk_output: The final output of the <cite>DenseNet</cite>. This is</p>
<blockquote>
<div><p>where a <cite>fully_connected</cite> head is normally attached.</p>
</div></blockquote>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>small_input</strong> – set to <cite>True</cite> for 32x32 sized image inputs.</p></li>
<li><p><strong>final_bn_relu</strong> – set to <cite>False</cite> to exclude the final batchnorm and
ReLU layers. These settings are useful when training Siamese
networks.</p></li>
<li><p><strong>use_se</strong> – Enable squeeze and excitation</p></li>
<li><p><strong>se_reduction_ratio</strong> – The reduction ratio to apply in the excitation
stage. Only used if <cite>use_se</cite> is <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.DenseNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.DenseNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.DenseNet.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.models.DenseNet" title="classy_vision.models.densenet.DenseNet"><span class="pre">classy_vision.models.densenet.DenseNet</span></a></span></span><a class="headerlink" href="#classy_vision.models.DenseNet.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a DenseNet from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for a DenseNet.
See <a class="reference internal" href="#classy_vision.models.DenseNet.__init__" title="classy_vision.models.DenseNet.__init__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__init__()</span></code></a> for parameters expected in the config.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A DenseNet instance.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.EfficientNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">EfficientNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.EfficientNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of EfficientNet, <a class="reference external" href="https://arxiv.org/pdf/1905.11946.pdf">https://arxiv.org/pdf/1905.11946.pdf</a>
.. rubric:: References</p>
<p><a class="reference external" href="https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet">https://github.com/tensorflow/tpu/tree/master/models/official/efficientnet</a>
<a class="reference external" href="https://github.com/lukemelas/EfficientNet-PyTorch">https://github.com/lukemelas/EfficientNet-PyTorch</a></p>
<dl class="simple">
<dt>NOTE: the original implementation uses the names depth_divisor and min_depth</dt><dd><p>to refer to the number of channels, which is confusing, since the paper
refers to the channel dimension as width. We use the width_divisor and
min_width names instead.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.EfficientNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">classy_vision.models.efficientnet.EfficientNetParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_momentum</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bn_epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_divisor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_connect_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_se</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.EfficientNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for ClassyModel.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.EfficientNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.EfficientNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.EfficientNet.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.EfficientNet.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates an EfficientNet from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for an EfficientNet.
See <a class="reference internal" href="#classy_vision.models.EfficientNet.__init__" title="classy_vision.models.EfficientNet.__init__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__init__()</span></code></a> for parameters expected in the config.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A ResNeXt instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="classy_vision.models.EfficientNet.input_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#classy_vision.models.EfficientNet.input_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the input shape that the model can accept, excluding the batch dimension.</p>
<p>By default it returns (3, 224, 224).</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.MLP" title="Permalink to this definition">¶</a></dt>
<dd><p>MLP model using ReLU. Useful for testing on CPUs.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.MLP.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dims</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_dropout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_batchnorm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_batchnorm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.MLP.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for ClassyModel.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.MLP.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.MLP.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.MLP.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.models.MLP" title="classy_vision.models.mlp.MLP"><span class="pre">classy_vision.models.mlp.MLP</span></a></span></span><a class="headerlink" href="#classy_vision.models.MLP.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a MLP from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for a MLP.
See <a class="reference internal" href="#classy_vision.models.MLP.__init__" title="classy_vision.models.MLP.__init__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__init__()</span></code></a> for parameters expected in the config.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A MLP instance.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.RegNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">RegNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.RegNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of RegNet, a particular form of AnyNets.</p>
<p>See <a class="reference external" href="https://arxiv.org/abs/2003.13678">https://arxiv.org/abs/2003.13678</a> for introduction to RegNets, and details about
RegNetX and RegNetY models.</p>
<p>See <a class="reference external" href="https://arxiv.org/abs/2103.06877">https://arxiv.org/abs/2103.06877</a> for details about RegNetZ models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.RegNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">classy_vision.models.regnet.RegNetParams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.RegNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for ClassyModel.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.RegNet.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.RegNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.RegNet.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.models.RegNet" title="classy_vision.models.regnet.RegNet"><span class="pre">classy_vision.models.regnet.RegNet</span></a></span></span><a class="headerlink" href="#classy_vision.models.RegNet.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a RegNet from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for a RegNet.
See <cite>RegNetParams</cite> for parameters expected in the config.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A RegNet instance.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">ResNeXt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNeXt" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_planes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">small_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_init_bn_residuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_width_and_cardinality</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basic_layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_bn_relu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_se</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">se_reduction_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNeXt.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of <a class="reference external" href="https://arxiv.org/pdf/1611.05431.pdf">ResNeXt</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>small_input</strong> – set to <cite>True</cite> for 32x32 sized image inputs.</p></li>
<li><p><strong>final_bn_relu</strong> – set to <cite>False</cite> to exclude the final batchnorm and
ReLU layers. These settings are useful when training Siamese
networks.</p></li>
<li><p><strong>use_se</strong> – Enable squeeze and excitation</p></li>
<li><p><strong>se_reduction_ratio</strong> – The reduction ratio to apply in the excitation
stage. Only used if <cite>use_se</cite> is <cite>True</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNeXt.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.models.ResNeXt" title="classy_vision.models.resnext.ResNeXt"><span class="pre">classy_vision.models.resnext.ResNeXt</span></a></span></span><a class="headerlink" href="#classy_vision.models.ResNeXt.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a ResNeXt from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for a ResNeXt.
See <a class="reference internal" href="#classy_vision.models.ResNeXt.__init__" title="classy_vision.models.ResNeXt.__init__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__init__()</span></code></a> for parameters expected in the config.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A ResNeXt instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt.get_classy_state">
<span class="sig-name descname"><span class="pre">get_classy_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep_copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNeXt.get_classy_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state of the ClassyModel.</p>
<p>The returned state is used for checkpointing.</p>
<dl class="simple">
<dt>NOTE: For advanced users, the structure of the returned dict is -</dt><dd><p><cite>{“model”: {“trunk”: trunk_state, “heads”: heads_state}}</cite>.
The trunk state is the state of the model when no heads are attached.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>deep_copy</strong> – If True, creates a deep copy of the state Dict. Otherwise, the
returned Dict’s state will be tied to the object’s.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A state dictionary containing the state of the model.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt.set_classy_state">
<span class="sig-name descname"><span class="pre">set_classy_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNeXt.set_classy_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the state of the ClassyModel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_dict</strong> – The state dictionary. Must be the output of a call to
<a class="reference internal" href="#classy_vision.models.ResNeXt.get_classy_state" title="classy_vision.models.ResNeXt.get_classy_state"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_classy_state()</span></code></a>.</p>
</dd>
</dl>
<p>This is used to load the state of the model from a checkpoint.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt3D">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">ResNeXt3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNeXt3D" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Implementation of:</dt><dd><p>1. Conventional <a class="reference external" href="https://arxiv.org/abs/1812.03982">post-activated 3D ResNe(X)t</a>.</p>
<p>2. <a class="reference external" href="https://arxiv.org/abs/1811.12814">Pre-activated 3D ResNe(X)t</a>.
The model consists of one stem, a number of stages, and one or multiple
heads that are attached to different blocks in the stage.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt3D.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_crop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_transformation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual_transformation_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frames_per_clip</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stem_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stem_planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stem_temporal_kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stem_spatial_kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stem_maxpool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_temporal_kernel_basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temporal_conv_1x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_temporal_stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_spatial_stride</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_per_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_init_residual_transform</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNeXt3D.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – a key that can index into model input that is
of dict type.</p></li>
<li><p><strong>input_planes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the channel dimension of the input. Normally 3 is used
for rgb input.</p></li>
<li><p><strong>clip_crop_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – spatial cropping size of video clip at train time.</p></li>
<li><p><strong>skip_transformation_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – the type of skip transformation.</p></li>
<li><p><strong>residual_transformation_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – the type of residual transformation.</p></li>
<li><p><strong>frames_per_clip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of frames in a video clip.</p></li>
<li><p><strong>num_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – list of the number of blocks in stages.</p></li>
<li><p><strong>stem_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of model stem.</p></li>
<li><p><strong>stem_planes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the output dimension of the convolution in the model
stem.</p></li>
<li><p><strong>stem_temporal_kernel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the temporal kernel size of the convolution
in the model stem.</p></li>
<li><p><strong>stem_spatial_kernel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the spatial kernel size of the convolution
in the model stem.</p></li>
<li><p><strong>stem_maxpool</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – If true, perform max pooling.</p></li>
<li><p><strong>stage_planes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the output channel dimension of the 1st residual stage</p></li>
<li><p><strong>stage_temporal_kernel_basis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><em>list</em></a>) – Basis of temporal kernel sizes for
each of the stage.</p></li>
<li><p><strong>temporal_conv_1x1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Only useful for BottleneckTransformation.
In a pathaway, if True, do temporal convolution in the first 1x1
Conv3d. Otherwise, do it in the second 3x3 Conv3d.</p></li>
<li><p><strong>stage_temporal_stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the temporal stride of the residual
transformation.</p></li>
<li><p><strong>stage_spatial_stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the spatial stride of the the residual
transformation.</p></li>
<li><p><strong>num_groups</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of groups for the convolution.
num_groups = 1 is for standard ResNet like networks, and
num_groups &gt; 1 is for ResNeXt like networks.</p></li>
<li><p><strong>width_per_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – Number of channels per group in 2nd (group)
conv in the residual transformation in the first stage</p></li>
<li><p><strong>zero_init_residual_transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – if true, the weight of last
operation, which could be either BatchNorm3D in post-activated
transformation or Conv3D in pre-activated transformation, in the
residual transformation is initialized to zero</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNeXt3D.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.models.ResNeXt3D" title="classy_vision.models.resnext3d.ResNeXt3D"><span class="pre">classy_vision.models.resnext3d.ResNeXt3D</span></a></span></span><a class="headerlink" href="#classy_vision.models.ResNeXt3D.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a ResNeXt3D from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for a ResNeXt3D.
See <a class="reference internal" href="#classy_vision.models.ResNeXt3D.__init__" title="classy_vision.models.ResNeXt3D.__init__"><code class="xref py py-func docutils literal notranslate"><span class="pre">__init__()</span></code></a> for parameters expected in the config.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A ResNeXt3D instance.</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.ResNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">ResNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNet" title="Permalink to this definition">¶</a></dt>
<dd><p>ResNet is a special case of <a class="reference internal" href="#classy_vision.models.ResNeXt" title="classy_vision.models.ResNeXt"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResNeXt</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.ResNet.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.ResNet.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>See <a class="reference internal" href="#classy_vision.models.ResNeXt.__init__" title="classy_vision.models.ResNeXt.__init__"><code class="xref py py-func docutils literal notranslate"><span class="pre">ResNeXt.__init__()</span></code></a></p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.SqueezeAndExcitationLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">SqueezeAndExcitationLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduced_planes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.0)"><span class="pre">torch.nn.modules.module.Module</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.SqueezeAndExcitationLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Squeeze and excitation layer, as per <a class="reference external" href="https://arxiv.org/pdf/1709.01507.pdf">https://arxiv.org/pdf/1709.01507.pdf</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.SqueezeAndExcitationLayer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_planes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduced_planes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.0)"><span class="pre">torch.nn.modules.module.Module</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.SqueezeAndExcitationLayer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.SqueezeAndExcitationLayer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.SqueezeAndExcitationLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.models.VisionTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">VisionTransformer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.VisionTransformer" title="Permalink to this definition">¶</a></dt>
<dd><p>Vision Transformer as per <a class="reference external" href="https://arxiv.org/abs/2010.11929">https://arxiv.org/abs/2010.11929</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.VisionTransformer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_dropout_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'token'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_stem_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.11)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><span class="pre">classy_vision.models.vision_transformer.ConvStemLayer</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.VisionTransformer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for ClassyModel.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.VisionTransformer.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.0)"><span class="pre">torch.Tensor</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.VisionTransformer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform computation of blocks in the order define in get_blocks.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.VisionTransformer.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.VisionTransformer.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a ClassyModel from a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> – A configuration for the ClassyModel.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A ClassyModel instance.</p>
</dd>
</dl>
</dd></dl>
<dl class="py property">
<dt class="sig sig-object py" id="classy_vision.models.VisionTransformer.input_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">input_shape</span></span><a class="headerlink" href="#classy_vision.models.VisionTransformer.input_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the input shape that the model can accept, excluding the batch dimension.</p>
<p>By default it returns (3, 224, 224).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.models.VisionTransformer.set_classy_state">
<span class="sig-name descname"><span class="pre">set_classy_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.VisionTransformer.set_classy_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the state of the ClassyModel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_dict</strong> – The state dictionary. Must be the output of a call to
<code class="xref py py-func docutils literal notranslate"><span class="pre">get_classy_state()</span></code>.</p>
</dd>
</dl>
<p>This is used to load the state of the model from a checkpoint.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="classy_vision.models.build_model">
<span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a ClassyModel from a config.</p>
<p>This assumes a ‘name’ key in the config which is used to determine what
model class to instantiate. For instance, a config <cite>{“name”: “my_model”,
“foo”: “bar”}</cite> will find a class that was registered as “my_model”
(see <a class="reference internal" href="#classy_vision.models.register_model" title="classy_vision.models.register_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_model()</span></code></a>) and call .from_config on it.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="classy_vision.models.register_model">
<span class="sig-prename descclassname"><span class="pre">classy_vision.models.</span></span><span class="sig-name descname"><span class="pre">register_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bypass_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.models.register_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a <a class="reference internal" href="#classy_vision.models.ClassyModel" title="classy_vision.models.ClassyModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassyModel</span></code></a> subclass.</p>
<p>This decorator allows Classy Vision to instantiate a subclass of
<a class="reference internal" href="#classy_vision.models.ClassyModel" title="classy_vision.models.ClassyModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassyModel</span></code></a> from a configuration file, even if the class itself is
not part of the Classy Vision framework. To use it, apply this decorator to
a ClassyModel subclass, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@register_model</span><span class="p">(</span><span class="s1">'resnet'</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ResidualNet</span><span class="p">(</span><span class="n">ClassyModel</span><span class="p">):</span>
   <span class="o">...</span>
</pre></div>
</div>
<p>To instantiate a model from a configuration file, see
<a class="reference internal" href="#classy_vision.models.build_model" title="classy_vision.models.build_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_model()</span></code></a>.</p>
</dd></dl>
</section>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Classy Vision</a></h1>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="heads.html">Heads</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="meters.html">Meters</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="param_scheduler.html">Param Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainer.html">Trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="index.html">Documentation overview</a><ul>
<li>Previous: <a href="meters.html" title="previous chapter">Meters</a></li>
<li>Next: <a href="optim.html" title="next chapter">Optimizers</a></li>
</ul></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="search.html" class="search" method="get">
<input aria-labelledby="searchlabel" autocapitalize="off" autocomplete="off" autocorrect="off" name="q" spellcheck="false" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</div>
<script>$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><div class="footerSection"><h5>Documentation</h5><a href="/tutorials/">Tutorials</a><a href="/api/">API Reference</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/facebookresearch/ClassyVision" data-count-href="https://github.com/facebookresearch/ClassyVision/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star Classy Vision on GitHub">ClassyVision</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright"><span>Copyright © 2023 Meta Platforms, Inc</span> <br/>Legal:  <a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a> <a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></section><script>
            (function() {
              var BAD_BASE = '/classyvision/';
              if (window.location.origin !== 'https://classyvision.ai') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://classyvision.ai/' + newPathname;
                console.log('redirecting to ' + newLocation);
                window.location.href = newLocation;
              }
            })();
          </script></footer></div></body></html>