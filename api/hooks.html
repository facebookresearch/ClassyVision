<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Classy Vision · An end-to-end framework for image and video classification</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="An end-to-end framework for image and video classification"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Classy Vision · An end-to-end framework for image and video classification"/><meta property="og:type" content="website"/><meta property="og:url" content="https://classyvision.ai/"/><meta property="og:description" content="An end-to-end framework for image and video classification"/><meta property="og:image" content="https://classyvision.ai/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://classyvision.ai/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code_block_buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.png" alt="Classy Vision"/><h2 class="headerTitleWithLogo">Classy Vision</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/api/" target="_self">API Reference</a></li><li class=""><a href="https://github.com/facebookresearch/ClassyVision" target="_self">GitHub</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div>
<script type="text/javascript" id="documentation_options" data-url_root="./"
  src="/js/documentation_options.js"></script>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/underscore.js"></script>
<script type="text/javascript" src="/js/doctools.js"></script>
<script type="text/javascript" src="/js/language_data.js"></script>
<script type="text/javascript" src="/js/searchtools.js"></script>
<div class="sphinx"><div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<section id="module-classy_vision.hooks">
<span id="hooks"></span><h1>Hooks<a class="headerlink" href="#module-classy_vision.hooks" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.CheckpointHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">CheckpointHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Collection" title="(in Python v3.11)"><span class="pre">Collection</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.CheckpointHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to checkpoint a model’s task.</p>
<p>Saves the checkpoints in checkpoint_folder.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.CheckpointHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">checkpoint_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_types</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Collection" title="(in Python v3.11)"><span class="pre">Collection</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.CheckpointHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of CheckpointHook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint_folder</strong> – Folder to store checkpoints in</p></li>
<li><p><strong>input_args</strong> – Any arguments to save about the runtime setup. For example,
it is useful to store the config that was used to instantiate the model.</p></li>
<li><p><strong>phase_types</strong> – If <cite>phase_types</cite> is specified, only checkpoint on those phase
types. Each item in <cite>phase_types</cite> must be either “train” or “test”. If
not specified, it is set to checkpoint after “train” phases.</p></li>
<li><p><strong>checkpoint_period</strong> – Checkpoint at the end of every x phases (default 1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.CheckpointHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.CheckpointHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.CheckpointHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.CheckpointHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Checkpoint the task every checkpoint_period phases.</p>
<p>We do not necessarily checkpoint the task at the end of every phase.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.CheckpointHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.CheckpointHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.CheckpointHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.CheckpointHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.CheckpointHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.CheckpointHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">ClassyHook</span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for hooks.</p>
<p>Hooks allow to inject behavior at different places of the training loop, which
are listed below in the chronological order.</p>
<blockquote>
<div><dl class="simple">
<dt>on_start -&gt; on_phase_start -&gt;</dt><dd><p>on_step -&gt; on_phase_end -&gt; on_end</p>
</dd>
</dl>
</div></blockquote>
<p>Deriving classes should call <code class="docutils literal notranslate"><span class="pre">super().__init__()</span></code> and store any state in
<code class="docutils literal notranslate"><span class="pre">self.state</span></code>. Any state added to this property should be serializable.
E.g. -</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyHook</span><span class="p">(</span><span class="n">ClassyHook</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="s2">"my_hook"</span>
        <span class="c1"># the following line is not allowed</span>
        <span class="c1"># self.state.my_lambda = lambda x: x^2</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.get_classy_state">
<span class="sig-name descname"><span class="pre">get_classy_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.get_classy_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state of the ClassyHook.</p>
<p>The returned state is used for checkpointing.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A state dictionary containing the state of the hook.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the name of the class.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.on_end">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.on_phase_end">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of each phase (epoch).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.on_phase_start">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of each phase.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.on_start">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.on_step">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called each time after parameters have been updated by the optimizer.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHook.set_classy_state">
<span class="sig-name descname"><span class="pre">set_classy_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ClassyHook.set_classy_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the state of the ClassyHook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_dict</strong> – The state dictionary. Must be the output of a call to
<a class="reference internal" href="#classy_vision.hooks.ClassyHook.get_classy_state" title="classy_vision.hooks.ClassyHook.get_classy_state"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_classy_state()</span></code></a>.</p>
</dd>
</dl>
<p>This is used to load the state of the hook from a checkpoint.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.ClassyHookFunctions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">ClassyHookFunctions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.ClassyHookFunctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Enumeration of all the hook functions in the ClassyHook class.</p>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">ExponentialMovingAverageModelHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_bn_buffers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook which keeps a track of the exponential moving average (EMA) of the model’s
parameters and applies the EMA params to the model during the test phases.</p>
<p>Saving the state in cpu will save gpu memory, but will make training slower since
the model parameters will need to be moved to cpu before the averaging.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This hooks stores two additional copies of the model’s parameters, which will
increase memory usage significantly.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_bn_buffers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of ExponentialMovingAverageModelHook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>decay</strong> – EMA decay factor, should be in [0, 1]. A decay of 0 corresponds to
always using the latest value (no EMA) and a decay of 1 corresponds to
not updating weights after initialization.</p></li>
<li><p><strong>consider_bn_buffers</strong> – Whether to apply EMA to batch norm buffers</p></li>
<li><p><strong>device</strong> – Device to store the model state.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.get_model_state_iterator">
<span class="sig-name descname"><span class="pre">get_model_state_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.0)"><span class="pre">torch.nn.modules.module.Module</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.get_model_state_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an iterator over the model state to apply EMA to.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of each phase (epoch).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of each phase.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called each time after parameters have been updated by the optimizer.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ExponentialMovingAverageModelHook.set_model_state">
<span class="sig-name descname"><span class="pre">set_model_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ema</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ExponentialMovingAverageModelHook.set_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Depending on use_ema, set the appropriate state for the model.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.LossLrMeterLoggingHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">LossLrMeterLoggingHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.LossLrMeterLoggingHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs the loss, optimizer LR, and meters. Logs at the end of a phase.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.LossLrMeterLoggingHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.LossLrMeterLoggingHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of LossLrMeterLoggingHook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>log_freq</strong> – if specified, also logs every <code class="docutils literal notranslate"><span class="pre">log_freq</span></code> batches.</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.LossLrMeterLoggingHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.LossLrMeterLoggingHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.LossLrMeterLoggingHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.LossLrMeterLoggingHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the loss, optimizer LR, and meters for the phase.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.LossLrMeterLoggingHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.LossLrMeterLoggingHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.LossLrMeterLoggingHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.LossLrMeterLoggingHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.LossLrMeterLoggingHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.LossLrMeterLoggingHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Log the LR every log_freq batches, if log_freq is not None.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelComplexityHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">ModelComplexityHook</span></span><a class="headerlink" href="#classy_vision.hooks.ModelComplexityHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Logs the number of paramaters and forward pass FLOPs and activations of the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelComplexityHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelComplexityHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelComplexityHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelComplexityHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelComplexityHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelComplexityHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelComplexityHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelComplexityHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelComplexityHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelComplexityHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure number of parameters, FLOPs and activations.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelComplexityHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelComplexityHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">ModelTensorboardHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb_writer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows the model graph in <cite>TensorBoard &lt;https
://www.tensorflow.org/tensorboard</cite>&gt;_.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb_writer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of ModelTensorboardHook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tb_writer</strong> – <a href="#id1"><span class="problematic" id="id2">`</span></a>Tensorboard SummaryWriter &lt;<a class="reference external" href="https://tensorboardx">https://tensorboardx</a>.</p></li>
<li><p><strong>readthedocs.io/en/latest/tensorboard.html#tensorboardX.</strong> – </p></li>
<li><p><strong>None</strong> (<em>SummaryWriter&gt;`_ instance or</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.hooks.ModelTensorboardHook" title="classy_vision.hooks.model_tensorboard_hook.ModelTensorboardHook"><span class="pre">classy_vision.hooks.model_tensorboard_hook.ModelTensorboardHook</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>The config is expected to include the key
“summary_writer” with arguments which correspond
to those listed at &lt;<a class="reference external" href="https://tensorboardx">https://tensorboardx</a>.
readthedocs.io/en/latest/tensorboard.html#tensorboardX.SummaryWriter&gt;:</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the model on Tensorboard.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ModelTensorboardHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ModelTensorboardHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.OutputCSVHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">OutputCSVHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.OutputCSVHook" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.OutputCSVHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.OutputCSVHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.OutputCSVHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.OutputCSVHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.OutputCSVHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.OutputCSVHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of each phase (epoch).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.OutputCSVHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.OutputCSVHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.OutputCSVHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.OutputCSVHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.OutputCSVHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.OutputCSVHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the output of the model to a CSV file.</p>
<p>This hook assumes the dataset provides an “id” key. It also expects the
task to provide an output of shape (B, C) where B is the batch size and
C is the number of classes. Targets can be either one-hot encoded or
single numbers.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.PreciseBatchNormHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">PreciseBatchNormHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.PreciseBatchNormHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to compute precise batch normalization statistics.</p>
<p>Batch norm stats are calculated and updated during training, when the weights are
also changing, which makes the calculations imprecise. This hook recomputes the
batch norm stats at the end of a train phase to make them more precise. See
<a class="reference external" href="https://github.com/facebookresearch/fvcore/blob/master/fvcore/nn/precise_bn.py">fvcore’s documentation</a> for more information.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.PreciseBatchNormHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.PreciseBatchNormHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of PreciseBatchNormHook.</p>
<p>Caches the required number of samples on the CPU during train phases</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_samples</strong> – Number of samples to calculate the batch norm stats per replica</p></li>
<li><p><strong>cache_samples</strong> – If True, we cache samples at training stage. This avoids re-creating
data loaders, but consumes more memory. If False, we re-create data loader at the
end of phase, which might be slow for large dataset, but saves memory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.PreciseBatchNormHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.PreciseBatchNormHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.PreciseBatchNormHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.PreciseBatchNormHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of each phase (epoch).</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.PreciseBatchNormHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.PreciseBatchNormHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of each phase.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.PreciseBatchNormHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.PreciseBatchNormHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.PreciseBatchNormHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.PreciseBatchNormHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Called each time after parameters have been updated by the optimizer.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.ProfilerHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">ProfilerHook</span></span><a class="headerlink" href="#classy_vision.hooks.ProfilerHook" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Hook to profile a model and to show model runtime information, such as</dt><dd><p>the time breakdown in milliseconds of forward/backward pass.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProfilerHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProfilerHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProfilerHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProfilerHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProfilerHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProfilerHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProfilerHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProfilerHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Profile the forward pass.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProfilerHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProfilerHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.ProgressBarHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">ProgressBarHook</span></span><a class="headerlink" href="#classy_vision.hooks.ProgressBarHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Displays a progress bar to show progress in processing batches.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProgressBarHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProgressBarHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of ProgressBarHook.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProgressBarHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProgressBarHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProgressBarHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProgressBarHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the progress bar at the end of the phase.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProgressBarHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProgressBarHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Create and display a progress bar with 0 progress.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProgressBarHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProgressBarHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.ProgressBarHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.ProgressBarHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the progress bar with the batch size.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">TensorboardPlotHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb_writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook for writing the losses, learning rates and meters to <cite>tensorboard &lt;https
://www.tensorflow.org/tensorboard</cite>&gt;_.</p>
<p>Global steps are counted in terms of the number of samples processed.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb_writer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of TensorboardPlotHook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tb_writer</strong> – <a href="#id3"><span class="problematic" id="id4">`</span></a>Tensorboard SummaryWriter &lt;<a class="reference external" href="https://tensorboardx">https://tensorboardx</a>.</p></li>
<li><p><strong>readthedocs.io/en/latest/tensorboard.html#tensorboardX.</strong> – </p></li>
<li><p><strong>None</strong> (<em>SummaryWriter&gt;`_ instance or</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook.from_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference internal" href="#classy_vision.hooks.TensorboardPlotHook" title="classy_vision.hooks.tensorboard_plot_hook.TensorboardPlotHook"><span class="pre">classy_vision.hooks.tensorboard_plot_hook.TensorboardPlotHook</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook.from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>The config is expected to include the key
“summary_writer” with arguments which correspond
to those listed at &lt;<a class="reference external" href="https://tensorboardx">https://tensorboardx</a>.
readthedocs.io/en/latest/tensorboard.html#tensorboardX.SummaryWriter&gt;:</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the losses and learning rates to tensorboard.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize losses and learning_rates.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TensorboardPlotHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TensorboardPlotHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the observed learning rates.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.TorchscriptHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">TorchscriptHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torchscript_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.TorchscriptHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Hook to convert a task model into torch script.</p>
<p>Saves the torch scripts in torchscript_folder.</p>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TorchscriptHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">torchscript_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_trace</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trace_strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TorchscriptHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>The constructor method of TorchscriptHook.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>torchscript_folder</strong> – Folder to store torch scripts in.</p></li>
<li><p><strong>use_trace</strong> – set to true for tracing and false for scripting,</p></li>
<li><p><strong>trace_strict</strong> – run the tracer in a strict mode or not
(default: <code class="docutils literal notranslate"><span class="pre">True</span></code>). Only turn this off when you want the tracer to
record your mutable container types (currently <code class="docutils literal notranslate"><span class="pre">list</span></code>/<code class="docutils literal notranslate"><span class="pre">dict</span></code>)
and you are sure that the container you are using in your
problem is a <code class="docutils literal notranslate"><span class="pre">constant</span></code> structure and does not get used as
control flow (if, for) conditions.</p></li>
<li><p><strong>device</strong> – move to device before saving.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TorchscriptHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TorchscriptHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model into torchscript by the end of training/testing.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TorchscriptHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TorchscriptHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TorchscriptHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TorchscriptHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TorchscriptHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TorchscriptHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of training.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.TorchscriptHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.TorchscriptHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="classy_vision.hooks.VisdomHook">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">VisdomHook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.VisdomHook" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots metrics on to <a class="reference external" href="https://github.com/facebookresearch/visdom">Visdom</a>.</p>
<dl class="simple">
<dt>Visdom is a flexible tool for creating, organizing, and sharing visualizations</dt><dd><p>of live, rich data. It supports Python.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.VisdomHook.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">server</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'main'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_suffix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.VisdomHook.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>server</strong> – host name of the visdom server</p></li>
<li><p><strong>port</strong> – port of visdom server, such as 8097</p></li>
<li><p><strong>env</strong> – environment of visdom</p></li>
<li><p><strong>title_suffix</strong> – suffix that will be appended to the title</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.VisdomHook.on_end">
<span class="sig-name descname"><span class="pre">on_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.VisdomHook.on_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.VisdomHook.on_phase_end">
<span class="sig-name descname"><span class="pre">on_phase_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.VisdomHook.on_phase_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the metrics on visdom.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.VisdomHook.on_phase_start">
<span class="sig-name descname"><span class="pre">on_phase_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.VisdomHook.on_phase_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.VisdomHook.on_start">
<span class="sig-name descname"><span class="pre">on_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.VisdomHook.on_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="classy_vision.hooks.VisdomHook.on_step">
<span class="sig-name descname"><span class="pre">on_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#classy_vision.hooks.VisdomHook.on_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Derived classes can set their hook functions to this.</p>
<p>This is useful if they want those hook functions to not do anything.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="classy_vision.hooks.build_hook">
<span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">build_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hook_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.build_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a ClassyHook from a config.</p>
<p>This assumes a ‘name’ key in the config which is used to determine
what hook class to instantiate. For instance, a config <cite>{“name”:
“my_hook”, “foo”: “bar”}</cite> will find a class that was registered as
“my_hook” (see <a class="reference internal" href="#classy_vision.hooks.register_hook" title="classy_vision.hooks.register_hook"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_hook()</span></code></a>) and call .from_config on
it.</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="classy_vision.hooks.register_hook">
<span class="sig-prename descclassname"><span class="pre">classy_vision.hooks.</span></span><span class="sig-name descname"><span class="pre">register_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bypass_checks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.hooks.register_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Registers a <a class="reference internal" href="#classy_vision.hooks.ClassyHook" title="classy_vision.hooks.ClassyHook"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassyHook</span></code></a> subclass.</p>
<p>This decorator allows Classy Vision to instantiate a subclass of
<a class="reference internal" href="#classy_vision.hooks.ClassyHook" title="classy_vision.hooks.ClassyHook"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClassyHook</span></code></a> from a configuration file, even if the class
itself is not part of the base Classy Vision framework. To use it,
apply this decorator to a ClassyHook subclass, like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@register_hook</span><span class="p">(</span><span class="s1">'custom_hook'</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CustomHook</span><span class="p">(</span><span class="n">ClassyHook</span><span class="p">):</span>
   <span class="o">...</span>
</pre></div>
</div>
<p>To instantiate a hook from a configuration file, see
<a class="reference internal" href="#classy_vision.hooks.build_hook" title="classy_vision.hooks.build_hook"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_hook()</span></code></a>.</p>
</dd></dl>
</section>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Classy Vision</a></h1>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="heads.html">Heads</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="meters.html">Meters</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="param_scheduler.html">Param Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="trainer.html">Trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="index.html">Documentation overview</a><ul>
<li>Previous: <a href="heads.html" title="previous chapter">Heads</a></li>
<li>Next: <a href="losses.html" title="next chapter">Losses</a></li>
</ul></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="search.html" class="search" method="get">
<input aria-labelledby="searchlabel" autocapitalize="off" autocomplete="off" autocorrect="off" name="q" spellcheck="false" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</div>
<script>$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><div class="footerSection"><h5>Documentation</h5><a href="/tutorials/">Tutorials</a><a href="/api/">API Reference</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/facebookresearch/ClassyVision" data-count-href="https://github.com/facebookresearch/ClassyVision/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star Classy Vision on GitHub">ClassyVision</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright"><span>Copyright © 2023 Meta Platforms, Inc</span> <br/>Legal:  <a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noreferrer noopener">Privacy</a> <a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noreferrer noopener">Terms</a></section><script>
            (function() {
              var BAD_BASE = '/classyvision/';
              if (window.location.origin !== 'https://classyvision.ai') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://classyvision.ai/' + newPathname;
                console.log('redirecting to ' + newLocation);
                window.location.href = newLocation;
              }
            })();
          </script></footer></div></body></html>