<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Classy Vision · An end-to-end framework for image and video classification</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="An end-to-end framework for image and video classification"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Classy Vision · An end-to-end framework for image and video classification"/><meta property="og:type" content="website"/><meta property="og:url" content="https://classyvision.ai/"/><meta property="og:description" content="An end-to-end framework for image and video classification"/><meta property="og:image" content="https://classyvision.ai/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://classyvision.ai/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/css/code_block_buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/js/code_block_buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/favicon.png" alt="Classy Vision"/><h2 class="headerTitleWithLogo">Classy Vision</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/tutorials/" target="_self">Tutorials</a></li><li class=""><a href="/api/" target="_self">API Reference</a></li><li class=""><a href="https://github.com/facebookresearch/ClassyVision" target="_self">GitHub</a></li><li class=""><a target="_self"></a></li></ul></nav></div></header></div></div><div class="navPusher"><div>
<script type="text/javascript" id="documentation_options" data-url_root="./"
  src="/js/documentation_options.js"></script>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/underscore.js"></script>
<script type="text/javascript" src="/js/doctools.js"></script>
<script type="text/javascript" src="/js/language_data.js"></script>
<script type="text/javascript" src="/js/searchtools.js"></script>
<div class="sphinx"><div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<div class="section" id="module-classy_vision.trainer">
<span id="trainer"></span><h1>Trainer<a class="headerlink" href="#module-classy_vision.trainer" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="classy_vision.trainer.ClassyTrainer">
<em class="property">class </em><code class="sig-prename descclassname">classy_vision.trainer.</code><code class="sig-name descname">ClassyTrainer</code><span class="sig-paren">(</span><em class="sig-param">use_gpu: Optional[bool] = None</em>, <em class="sig-param">num_dataloader_workers: int = 0</em>, <em class="sig-param">dataloader_mp_context: Optional[str] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.trainer.ClassyTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for shared training code.</p>
<p>A trainer is responsible for setting up the environment for
training, for instance: configuring rendezvous for distributed
training, deciding what GPU to use and so on. Trainers also
control the outer portion of the training loop, but delegate to
the task to decide how exactly to perform inference, compute loss
etc. That allows combining tasks with different trainers depending
on whether you want to train on your current machine, AWS cluster
etc.</p>
<dl class="method">
<dt id="classy_vision.trainer.ClassyTrainer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">use_gpu: Optional[bool] = None</em>, <em class="sig-param">num_dataloader_workers: int = 0</em>, <em class="sig-param">dataloader_mp_context: Optional[str] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.trainer.ClassyTrainer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for ClassyTrainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> – If true, then use GPUs for training.
If None, then check if we have GPUs available, if we do
then use GPU for training.</p></li>
<li><p><strong>num_dataloader_workers</strong> – Number of CPU processes doing dataloading
per GPU. If 0, then dataloading is done on main thread.</p></li>
<li><p><strong>dataloader_mp_context</strong> – Determines how to launch
new processes for dataloading. Must be one of “fork”, “forkserver”,
“spawn”. If None, process launching is inherited from parent.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
<dl class="method">
<dt id="classy_vision.trainer.ClassyTrainer.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">task: classy_vision.tasks.classy_task.ClassyTask</em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.trainer.ClassyTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs training phases, phases are generated from the config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>task</strong> – Task to be used in training. It should contain
everything that is needed for training</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="classy_vision.trainer.DistributedTrainer">
<em class="property">class </em><code class="sig-prename descclassname">classy_vision.trainer.</code><code class="sig-name descname">DistributedTrainer</code><span class="sig-paren">(</span><em class="sig-param">use_gpu: Optional[bool] = None</em>, <em class="sig-param">num_dataloader_workers: int = 0</em>, <em class="sig-param">dataloader_mp_context: Optional[str] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.trainer.DistributedTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Distributed trainer for using multiple training processes</p>
<dl class="method">
<dt id="classy_vision.trainer.DistributedTrainer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">use_gpu: Optional[bool] = None</em>, <em class="sig-param">num_dataloader_workers: int = 0</em>, <em class="sig-param">dataloader_mp_context: Optional[str] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.trainer.DistributedTrainer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for DistributedTrainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> – If true, then use GPU 0 for training.
If None, then check if we have GPUs available, if we do
then use GPU for training.</p></li>
<li><p><strong>num_dataloader_workers</strong> – Number of CPU processes doing dataloading
per GPU. If 0, then dataloading is done on main thread.</p></li>
<li><p><strong>dataloader_mp_context</strong> – Determines how to launch
new processes for dataloading. Must be one of “fork”, “forkserver”,
“spawn”. If None, process launching is inherited from parent.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="classy_vision.trainer.LocalTrainer">
<em class="property">class </em><code class="sig-prename descclassname">classy_vision.trainer.</code><code class="sig-name descname">LocalTrainer</code><span class="sig-paren">(</span><em class="sig-param">use_gpu: Optional[bool] = None</em>, <em class="sig-param">num_dataloader_workers: int = 0</em>, <em class="sig-param">dataloader_mp_context: Optional[str] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.trainer.LocalTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Trainer to be used if you want want use only a single training process.</p>
<dl class="method">
<dt id="classy_vision.trainer.LocalTrainer.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">use_gpu: Optional[bool] = None</em>, <em class="sig-param">num_dataloader_workers: int = 0</em>, <em class="sig-param">dataloader_mp_context: Optional[str] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#classy_vision.trainer.LocalTrainer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for LocalTrainer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_gpu</strong> – If true, then use GPU 0 for training.
If None, then check if we have GPUs available, if we do
then use GPU for training.</p></li>
<li><p><strong>num_dataloader_workers</strong> – Number of CPU processes doing dataloading
per GPU. If 0, then dataloading is done on main thread.</p></li>
<li><p><strong>dataloader_mp_context</strong> – Determines how to launch
new processes for dataloading. Must be one of “fork”, “forkserver”,
“spawn”. If None, process launching is inherited from parent.</p></li>
</ul>
</dd>
</dl>
</dd></dl>
</dd></dl>
</div>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Classy Vision</a></h1>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="heads.html">Heads</a></li>
<li class="toctree-l1"><a class="reference internal" href="hooks.html">Hooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="losses.html">Losses</a></li>
<li class="toctree-l1"><a class="reference internal" href="meters.html">Meters</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="optim.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="param_scheduler.html">Param Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="index.html">Documentation overview</a><ul>
<li>Previous: <a href="tasks.html" title="previous chapter">Tasks</a></li>
<li>Next: <a href="transforms.html" title="next chapter">Transforms</a></li>
</ul></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="search.html" class="search" method="get">
<input aria-labelledby="searchlabel" name="q" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="clearer"></div>
</div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><div class="footerSection"><h5>Documentation</h5><a href="/tutorials/">Tutorials</a><a href="/api/">API Reference</a></div><div class="footerSection"><h5>Social</h5><div class="social"><a class="github-button" href="https://github.com/facebookresearch/ClassyVision" data-count-href="https://github.com/facebookresearch/ClassyVision/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star Classy Vision on GitHub">ClassyVision</a></div></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright"><span>Copyright © 2020 Facebook Inc.</span> </section><script>
            (function() {
              var BAD_BASE = '/classyvision/';
              if (window.location.origin !== 'https://classyvision.ai') {
                var pathname = window.location.pathname;
                var newPathname = pathname.slice(pathname.indexOf(BAD_BASE) === 0 ? BAD_BASE.length : 1);
                var newLocation = 'https://classyvision.ai/' + newPathname;
                console.log('redirecting to ' + newLocation);
                window.location.href = newLocation;
              }
            })();
          </script></footer></div></body></html>